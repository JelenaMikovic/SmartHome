<div class="basic-container" id="card-container" [ngClass]="{'card-container-50 transition': !isDetails}">
    <div [ngClass]="isDetails ? 'image-container' : 'image-container-details'">
        <img src={{device.image}} style="width: 100%; height: 100%; border-radius: 20px 0px 0px 20px; object-fit: cover;"/>
    </div>

    <div id="info-container">
        <div>
            <h2 class="light-blue">{{ device.name }}</h2>
        </div>
        <div>
            <i class="fa-solid fa-plug"></i>
            <span class="black">{{device.powerConsumption}} kWh consumption</span>
        </div>
        <div>
            <i class="fa-solid fa-plug"></i>
            <span class="black">{{ device.powerSource == 0 ? 'Alkaline' : (device.powerSource == 1 ? 'Battery' : 'Electrical grid') }} power source</span>
        </div>

        <div *ngIf="isDetails">
            <div *ngIf="device.deviceType === 'SOLAR_PANEL'">
                <i class="fa-solid fa-maximize"></i>
                <span class="black">{{ device.size }} m2</span>
            </div>
            <div *ngIf="device.deviceType === 'SOLAR_PANEL'">
                <i class="fa-solid fa-hashtag"></i>
                <span class="black">{{device.numberOfPanels}} panels</span>
            </div>
            <div *ngIf="device.deviceType === 'SOLAR_PANEL'">
                <i class="fa-solid fa-percent"></i>
                <span class="black">{{device.efficiency}} efficiency</span>
            </div>
            <div *ngIf="device.deviceType === 'AMBIENT_SENSOR'">
                <i class="fa-solid fa-sun"></i>
                <span class="black">{{device.currentTemperature}} C</span>
            </div>
            <div *ngIf="device.deviceType === 'AMBIENT_SENSOR'">
                <i class="fa-solid fa-percent"></i>
                <span class="black">{{device.currentHumidity}} %</span>
            </div>
            <div *ngIf="device.deviceType === 'LAMP'">
                <i class="fa-solid fa-sun"></i>
                <span class="black">{{device.brightnessLevel}} lux</span>
            </div>
        </div>

        <div style="float: right; margin-right: 15px; margin-bottom: -20px;">
            <div [ngClass]="{
                'active-status': device.isOnline == true,
                'denied-status': device.isOnline == false,
                'status': true
              }" class="active-button">{{ device.isOnline ? 'Online' : 'Offline' }}</div>
        </div>
    </div>
    <!-- && device.deviceType == 'SOLAR_PANEL' -->
</div>

<div *ngIf="isDetails" style="display: block; flex-direction: row; justify-content: space-between;">
    <div *ngIf="device.deviceType === 'AMBIENT_SENSOR'" class="basic-container smaller-container" style="width: 100%" id="card-container">        
        <div id="info-container">
            <h2>Current Values</h2>
            <div class="ambiental-sensor-container">
                <div id="current-temperature-chart-container" style="height: 400px;"></div>
            </div>
            <div class="ambiental-sensor-container">
                <div id="current-humidity-chart-container" style="height: 400px;"></div>
            </div>
        </div>
    </div>

    <div class="basic-container smaller-container" style="width: 30%;" id="card-container">
        <div id="info-container">
            <div>
                <h2 style="font-size: 1.2em" class="light-blue">Device actions</h2>
            </div>
            <div>
                <span class="black">power: </span>
                <mat-slide-toggle [(ngModel)]="checkedOnOff" (change)="toggleChangeOnOff()">
                </mat-slide-toggle>
            </div>
            <div *ngIf="device.deviceType == 'LAMP'">
                <span class="black">automatic regime: </span>
                <mat-slide-toggle [(ngModel)]="checkedAutomatic" (change)="toggleAutomaticRegime()">
                </mat-slide-toggle>
            </div>
        </div>
    </div>

    <div class="basic-container smaller-container" [ngStyle]="{'width': device.deviceType === 'AMBIENT_SENSOR' ? '100%' : '55%'}" id="card-container">        
        <div id="info-container">
            <div class="hover-opacity" style="display: flex; flex-direction: row; justify-content: space-around;">
                <div>
                    <h2 (click)="clickedReportsBy('interval')" style="font-size: 1.2em; cursor: pointer;" class="light-blue">Reports by interval</h2>
                </div>
                <div>
                    <h2 (click)="clickedReportsBy('date')" style="font-size: 1.2em; cursor: pointer;" class="light-blue">Reports by date</h2>
                </div>
            </div>
            
            <div style="display: flex; flex-direction: row; justify-content: space-between;" *ngIf="reportsBy=='interval'">
                <mat-form-field  id="type-dd">
                    <mat-label>Interval</mat-label>
                    <mat-select [(value)]="this.selectedTimeInterval" (selectionChange)="onIntervalSelected()">
                      <mat-option *ngFor="let item of timeIntervals" [value]="item" >
                        {{item}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <button class="conf-button add-prop-btn back-light-blue">generate</button>
            
            </div>
            <div *ngIf="isSelected" class="ambiental-sensor-container">
                <div id="temperature-chart-container" style="height: 400px;"></div>
            </div>
            <div *ngIf="isSelected" class="ambiental-sensor-container">
                <div id="humidity-chart-container" style="height: 400px;"></div>
            </div>
        </div>
    </div>
    <div>      
        <mat-form-field  appearance="fill">
            <mat-label>Search</mat-label>
            <input matInput placeholder="please enter a value" (input)="applyFilter($event)">
          </mat-form-field>
          
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" style = "width: 100%; justify-content: space-between; margin-top: 15px; margin-left: 5px;">

            <!-- Action Column -->
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Action</th>
              <td mat-cell *matCellDef="let element">{{ element.action }}</td>
            </ng-container>
          
            <!-- Time Column -->
            <ng-container matColumnDef="time">
              <th mat-header-cell *matHeaderCellDef>Time</th>
              <td mat-cell *matCellDef="let element">{{ element.time | date: 'medium' }}</td>
            </ng-container>
          
            <!-- By Who Column -->
            <ng-container matColumnDef="byWho">
              <th mat-header-cell *matHeaderCellDef>By Who</th>
              <td mat-cell *matCellDef="let element">{{ element.byWho }}</td>
            </ng-container>
          
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
    </div>
</div>
